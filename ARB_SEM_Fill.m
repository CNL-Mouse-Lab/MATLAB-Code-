%% arfread arf file to data set 
%5 Mon WT n = 8 (A)
data5MonWTF1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\07202021\WT_5Month_F1(whitetail)\WT_5Month_F1(whitetail).arf');
data5MonWTF2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\07202021\WT_5Month_F2(blacktail)\WT_5Month_F2(blacktail).arf');
data5MonWTM1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\07192021\WT_5Month_M1\WT_5Month_M1_5dB.arf');
data5MonWTM2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09212021\5MonWTM2\5MonWTM2(R4).arf');
data5MonWTM3 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09212021\5MonWTM3\5MonWTM3(R1).arf');
data5MonWTM4 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09212021\5MonWTM4\5MonWTM4(R3).arf');
data5MonWTM5 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11032021\5MonWTM5.arf');
data5MonWTM6 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11032021\5MonWTM6.arf');
%5 Mon CLN3 n = 9 (B)
data5MonCLN3M1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\07192021\CLN3_5Month_M1(R1)\CLN3_5Month_M1(R1).arf');
data5MonCLN3M2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\07202021\CLN3_5Month_M2(R3)\CLN3_5Month_M2(R3).arf');
data5MonCLN3M3 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\08132021\5Month_CLN3_M3(EEG)\5Month_CLN3_M3(EEG).arf');
data5MonCLN3M4 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11032021\5MonCLN3M4.arf');
data5MonCLN3M5 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11032021\5MonCLN3M5.arf');
data5MonCLN3F1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\07202021\CLN3_5Month_F1(L2)\CLN3_5Month_F1(L2).arf');
data5MonCLN3F2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\07202021\CLN3_5Month_F2(R4)\CLN3_5Month_F2(R4).arf');
data5MonCLN3F3 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11122021\5MonCLN3F3.arf');
data5MonCLN3F4 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11122021\5MonCLN3F4.arf');
%3 Mon WT n = 5 (C)
data3MonWTM1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\08102021\3 Month_WT_M1\3Month_WT_M1.arf');
data3MonWTM2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09092021\3MonWTM2\3MonWTM2.arf');
data3MonWTM3 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09092021\3MonWTM3\3MonWTM3.arf');
data3MonWTM4 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09092021\3MonWTM4\3MonWTM4.arf');
data3MonWTM5 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09212021\3MonWTM5\3MonWTM5(R3).arf');
%3 Mon CLN3 n = 9 (D)
data3MonCLN3M1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\08102021\3 Month_CLN3_M1\3Month_CLN3_M1.arf');
data3MonCLN3M2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09092021\3MonCLN3M2\3MonCLN3M2.arf');
data3MonCLN3M3 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09092021\3MonCLN3M3\3MonCLN3M3.arf');
data3MonCLN3M4 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09092021\3MonCLN3M4\3MonCLN3M4.arf');
data3MonCLN3M5 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09092021\3MonCLN3M5\3MonCLN3M5.arf');
data3MonCLN3M6 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11112021\3MonCLN3M6.arf');
data3MonCLN3M7 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11112021\3MonCLN3M7.arf');
data3MonCLN3M8 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11112021\3MonCLN3M8.arf');
data3MonCLN3M9 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11112021\3MonCLN3M9.arf');
%1 Mon WT n = 10 (E)
data1MonWTM1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\08022021\1Month_WT_M1_(R4)\1Month_WT_M1_(R4).arf');
data1MonWTM2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\08022021\1Month_WT_M2_(L1)\1Month_WT_M2_(L1).arf');
data1MonWTM3 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\08032021\1Month_WT_M3_(R2)\1Month_WT_M3_(R2).arf');
data1MonWTM4 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09202021\1MonWTM4(R1)\1MonWTM4(rR1).arf');
data1MonWTM5 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09202021\1MonWTM5(R3)\1MonWTM5(R3).arf');
data1MonWTF1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09202021\1MonWTF1(R1)\1MonWTF1(R1).arf');
data1MonWTF2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09202021\1MonWTF2(L3)\1MonWTF2(L3).arf');
data1MonWTF3 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11122021\1MonWTF3.arf');
data1MonWTF4 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11122021\1MonWTF4.arf');
data1MonWTF5 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\11122021\1MonWTF5.arf');
% 1 Mon CLN3 n = 9 (F)
data1MonCLN3M1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\08032021\1Month_CLN3_M1_(R2)\1Month_CLN3_M1_(R2).arf');
data1MonCLN3M2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09132021\1MonCLN3M2\1MonCLN3M2.arf');
data1MonCLN3M3 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09132021\1MonCLN3M3\1MonCLN3M3.arf');
data1MonCLN3M4 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09132021\1MonCLN3M4\1MonCLN3M4.arf');
data1MonCLN3M5 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09132021\1MonCLN3M5\1MonCLN3M5.arf');
data1MonCLN3F1 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\08032021\1Month_CLN3_F1_(L1)\1Month_CLN3_F1_(L1).arf');
data1MonCLN3F2 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09132021\1MonCLN3F2\1MonCLN3F2.arf');
data1MonCLN3F3 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09132021\1MonCLN3F3\1MonCLN3F3.arf');
data1MonCLN3F4 = arfread('C:\Users\yding35\Box\ABR\ABR raw data\09132021\1MonCLN3F4\1MonCLN3F4.arf');
%% Data Extraction
%5 Month WT 
%WT 5 Month F1 80dB
A1 = data5MonWTF1.groups.recs(3).data;
A1 = A1';
%WT 5 Month F2 80dB
A2 = data5MonWTF2.groups.recs(3).data;
A2 = A2';
%WT 5 Month M1 80dB
A3 = data5MonWTM1.groups.recs(3).data;
A3 = A3';
%WT 5 Month M2 80dB 
A4 = data5MonWTM2.groups.recs(3).data;
A4 = A4';
%WT 5 Month M3 80dB 
A5 = data5MonWTM3.groups.recs(3).data;
A5 = A5';
%WT 5 Month M4 80dB 
A6 = data5MonWTM4.groups.recs(3).data;
A6 = A6';
%WT 5 Month M5 80dB 
A7 = data5MonWTM5.groups.recs(3).data;
A7 = A7';
%WT 5 Month M6 80dB 
A8 = data5MonWTM6.groups.recs(3).data;
A8 = A8';
%% 5 Mon CLN3 
%ClN3 5 Month M1 80dB
B1 = data5MonCLN3M1.groups.recs(3).data;
B1 = B1';
%ClN3 5 Month M2 80dB
B2 = data5MonCLN3M2.groups.recs(3).data;
B2 = B2';
%ClN3 5 Month M3 80dB
B3 = data5MonCLN3M3.groups.recs(3).data;
B3 = B3';
%ClN3 5 Month M4 80dB
B4 = data5MonCLN3M4.groups.recs(3).data;
B4 = B4';
%ClN3 5 Month M5 80dB
B5 = data5MonCLN3M5.groups.recs(3).data;
B5 = B5';
%ClN3 5 Month F1
B6 = data5MonCLN3F1.groups.recs(3).data;
B6 = B6';
%ClN3 5 Month F2
B7 = data5MonCLN3F2.groups.recs(3).data;
B7 = B7';
%ClN3 5 Month F3
B8 = data5MonCLN3F3.groups.recs(3).data;
B8 = B8';
%ClN3 5 Month F4
B9 = data5MonCLN3F4.groups.recs(3).data;
B9 = B9';
%% 3Month WT M1
C1 = data3MonWTM1.groups.recs(3).data;
C1 = C1';
%3 Month WT M2
C2 = data3MonWTM2.groups.recs(3).data;
C2 = C2';
%3 Month WT M3
C3 = data3MonWTM3.groups.recs(3).data;
C3 = C3';
%3Month WT M4
C4 = data3MonWTM4.groups.recs(3).data;
C4 = C4';
%3 Month WT M5 
C5 = data3MonWTM5.groups.recs(3).data;
C5 = C5';
%% 3 Month CLN3 
%3 Month CLN3 M1
D1 = data3MonCLN3M1.groups.recs(3).data;
D1 = D1';
%3 Month CLN3 M2
D2 = data3MonCLN3M2.groups.recs(3).data;
D2 = D2';
%3 Month CLN3 M3
D3 = data3MonCLN3M3.groups.recs(3).data;
D3 = D3';
%3 Month CLN3 M4
D4 = data3MonCLN3M4.groups.recs(3).data;
D4 = D4';
%3 Month CLN3 M5
D5 = data3MonCLN3M5.groups.recs(3).data;
D5 = D5';
%3 Month CLN3 M2
D6 = data3MonCLN3M6.groups.recs(3).data;
D6 = D6';
%3 Month CLN3 M3
D7 = data3MonCLN3M7.groups.recs(3).data;
D7 = D7';
%3 Month CLN3 M4
D8 = data3MonCLN3M8.groups.recs(3).data;
D8 = D8';
%3 Month CLN3 M5
D9 = data3MonCLN3M9.groups.recs(3).data;
D9 = D9';
%% 1 Month WT 
%WT 1 Month M1 
E1 = data1MonWTM1.groups.recs(3).data;
E1 = E1';
%WT 1 Month M2 
E2 = data1MonWTM2.groups.recs(3).data;
E2 = E2';
%WT 1 Month M3 
E3 = data1MonWTM3.groups.recs(3).data;
E3 = E3';
%WT 1 Month M4 
E4 = data1MonWTM4.groups(1).recs(3).data;
E4 = E4';
%WT 1 Month M5 
E5 = data1MonWTM5.groups.recs(3).data;
E5 = E5';
%WT 1 Month F1 
E6 = data1MonWTF1.groups.recs(3).data;
E6 = E6';
%WT 1 Month F2 
E7 = data1MonWTF2.groups.recs(3).data;
E7 = E7';
%WT 1 Month F3 
E8 = data1MonWTF3.groups.recs(3).data;
E8 = E8';
%WT 1 Month F4 
E9 = data1MonWTF4.groups.recs(3).data;
E9 = E9';
%WT 1 Month F5 
E10 = data1MonWTF5.groups.recs(3).data;
E10 = E10';
%% 1 Month CLN3 
%ClN3 1 Month M1
F1 = data1MonCLN3M1.groups.recs(3).data;
F1 = F1';
%ClN3 1 Month F1
F2 = data1MonCLN3F1.groups.recs(3).data;
F2 = F2';
%1 Month CLN3 F2 
F3 = data1MonCLN3F2.groups.recs(3).data;
F3 = F3';
%1 Month CLN3 F3 
F4 = data1MonCLN3F3.groups.recs(3).data;
F4 = F4';
%1 Month CLN3 F4
F5 = data1MonCLN3F4.groups.recs(3).data;
F5 = F5';
%1 Month CLN3 M2 
F6 = data1MonCLN3M2.groups.recs(3).data;
F6 = F6';
%1 Month CLN3 M3
F7 = data1MonCLN3M3.groups.recs(3).data;
F7 = F7';
%1 Month CLN3 M4
F8 = data1MonCLN3M4.groups.recs(3).data;
F8 = F8';
%1 Month CLN3 M5 
F9 = data1MonCLN3M5.groups.recs(3).data;
F9 = F9';
%% Mean, STE and FIll for plotting
OneMonWT = [E1;E2;E3;E4;E5;E6;E7;E8;E9;E10];
ThreeMonWT = [C1;C2;C3;C4;C5];
FiveMonWT = [A1;A2;A3;A4;A5;A6;A7;A8];
OneMonCLN3 = [F1;F2;F3;F4;F5;F6;F7;F8;F9];
ThreeMonCLN3 = [D1;D2;D3;D4;D5;D6;D7;D8;D9];
FiveMonCLN3 = [B1;B2;B3;B4;B5;B6;B7;B8;B9];
%Average
OneMonWTMean = mean(OneMonWT,1);
ThreeMonWTMean = mean(ThreeMonWT,1);
FiveMonWTMean = mean(FiveMonWT,1);
OneMonCLN3Mean = mean(OneMonCLN3,1);
ThreeMonCLN3Mean = mean(ThreeMonCLN3,1);
FiveMonCLN3Mean = mean(FiveMonCLN3,1);
%STD
OneMonWTSTD = std(OneMonWT,1);
ThreeMonWTSTD = std(ThreeMonWT,1);
FiveMonWTSTD = std(ThreeMonWT,1);
OneMonCLN3STD = std(OneMonCLN3,1);
ThreeMonCLN3STD = std(ThreeMonCLN3,1);
FiveMonCLN3STD = std(ThreeMonCLN3,1);
%STE
OneMonWTSTE = OneMonWTSTD./sqrt(10);
ThreeMonWTSTE = ThreeMonWTSTD./sqrt(5);
FiveMonWTSTE = FiveMonWTSTD./sqrt(8);
OneMonCLN3STE = OneMonCLN3STD./sqrt(9);
ThreeMonCLN3STE = ThreeMonCLN3STD./sqrt(9);
FiveMonCLN3STE = FiveMonCLN3STD./sqrt(9);
%fill
nFrame = 244;
timeV = (1:nFrame)/25000 * 1000;
uB = OneMonWTMean + OneMonWTSTE;
lB = OneMonWTMean - OneMonWTSTE;
uB1 = ThreeMonWTMean + ThreeMonWTSTE;
lB1 = ThreeMonWTMean - ThreeMonWTSTE;
uB2 = FiveMonWTMean + FiveMonWTSTE;
lB2 = FiveMonWTMean - FiveMonWTSTE;
uB3 = OneMonCLN3Mean + OneMonCLN3STE;
lB3 = OneMonCLN3Mean - OneMonCLN3STE;
uB4 = ThreeMonCLN3Mean + ThreeMonCLN3STE;
lB4 = ThreeMonCLN3Mean - ThreeMonCLN3STE;
uB5 = FiveMonCLN3Mean + FiveMonCLN3STE;
lB5 = FiveMonCLN3Mean - FiveMonCLN3STE;
%% Plotting
%figure 1 for 1 Mon 3 Mon 5 Mon WT comparison
figure;
hold on;
plot(timeV,OneMonWTMean,'r-','linewidth',2,'color','blue');
fill([timeV(:);flipud(timeV(:))],...
    [uB(:);flipud(lB(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','blue');
plot(timeV,ThreeMonWTMean,'r-','linewidth',2,'color','red');
fill([timeV(:);flipud(timeV(:))],...
    [uB1(:);flipud(lB1(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','red');
plot(timeV,FiveMonWTMean,'r-','linewidth',2,'color','green');
fill([timeV(:);flipud(timeV(:))],...
    [uB2(:);flipud(lB2(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','green');
ylim([-8e-6,6e-6]); 
ylabel('Amplitude volt(v)');
xlabel('Time (ms)');
title('1 Month 3 Month 5 Month WT 80dB SPL');
hold off;
%figure 2 for 1 Mon 3 Mon 5 Mon CLN3 comparison
figure;
hold on;
plot(timeV,OneMonCLN3Mean,'r-','linewidth',2,'color','blue');
fill([timeV(:);flipud(timeV(:))],...
    [uB3(:);flipud(lB3(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','blue');
plot(timeV,ThreeMonCLN3Mean,'r-','linewidth',2,'color','red');
fill([timeV(:);flipud(timeV(:))],...
    [uB4(:);flipud(lB4(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','red');
plot(timeV,FiveMonCLN3Mean,'r-','linewidth',2,'color','green');
fill([timeV(:);flipud(timeV(:))],...
    [uB5(:);flipud(lB5(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','green');
ylim([-8e-6,6e-6]); 
ylabel('Amplitude volt(v)');
xlabel('Time (ms)');
title('1 Month 3 Month 5 Month CLN3 80dB SPL');
hold off;
%Figure 3 for 1 Mon WT CLN3
figure;
hold on;
plot(timeV,OneMonWTMean,'r-','linewidth',2,'color','r');
fill([timeV(:);flipud(timeV(:))],...
    [uB(:);flipud(lB(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','r');
plot(timeV,OneMonCLN3Mean,'r-','linewidth',2,'color','b');
fill([timeV(:);flipud(timeV(:))],...
    [uB3(:);flipud(lB3(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','b');
ylim([-8e-6,6e-6]); 
ylabel('Amplitude volt(v)');
xlabel('Time (ms)');
title('1 Month WT CLN3 80dB SPL');
hold off;
%Figure 4 for 3 Mon WT CLN3
figure;
hold on;
plot(timeV,ThreeMonWTMean,'r-','linewidth',2,'color','r');
fill([timeV(:);flipud(timeV(:))],...
    [uB1(:);flipud(lB1(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','r');
plot(timeV,ThreeMonCLN3Mean,'r-','linewidth',2,'color','b');
fill([timeV(:);flipud(timeV(:))],...
    [uB4(:);flipud(lB4(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','b');
ylim([-8e-6,6e-6]); 
ylabel('Amplitude volt(v)');
xlabel('Time (ms)');
title('3 Month WT CLN3 80dB SPL');
hold off;
%Figure 5 for 5 Mon WT CLN3
figure;
hold on;
plot(timeV,FiveMonWTMean,'r-','linewidth',2,'color','r');
fill([timeV(:);flipud(timeV(:))],...
    [uB2(:);flipud(lB2(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','r');
plot(timeV,FiveMonCLN3Mean,'r-','linewidth',2,'color','b');
fill([timeV(:);flipud(timeV(:))],...
    [uB5(:);flipud(lB5(:))],...
    'r','facealpha',0.5,'edgecolor','none','facecolor','b');
ylim([-8e-6,6e-6]); 
ylabel('Amplitude volt(v)');
xlabel('Time (ms)');
title('5 Month WT CLN3 80dB SPL');
hold off;